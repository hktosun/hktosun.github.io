boot_all[i,2] <- as.numeric(bounds_all_b[2,2])
}
ci <- 0
kl_all <- 0
ku_all <- 0
while(ci < N*0.95){
UB_all <- (bounds_all_o[2,2] + ku_all)
LB_all <- (bounds_all_o[1,2] - kl_all)
for (i in 1:N){
boot_all[i,3] <- (boot_all[i,2]<UB_all)*(boot_all[i,1]>LB_all)
}
kl_all <- kl_all + sd(boot_all[,1])/20
ku_all <- ku_all + sd(boot_all[,2])/20
ci <- sum(boot_all[,3])
}
table_all <- matrix(nrow = 1, ncol = 4)
table_all[1,1] <- as.numeric(bounds_all_o[1,2])
table_all[1,2] <- as.numeric(bounds_all_o[2,2])
table_all[1,3] <- as.numeric(LB_all)
table_all[1,4] <- as.numeric(UB_all)
table_all <- as.data.frame(table_all)
names(table_all) <- c("LB", "UB", "LB for 95% CI", "UB for 95% CI")
rm(UB_all,LB_all,kl_all,ku_all,boot_all,bounds_all_b,bounds_all_o)
print(table_all)
# PART B ------------------------------------------------------------------
bounds_dest_o <- da %>% group_by(destination, export) %>% summarize(me = sum(revenue)/n())
# Estimation with Bootstrapped Dataset ------------------------------------
boot_dest <- matrix(nrow = N, ncol = 15)
for(i in 1:N){
bounds_dest_b <- da %>% group_by(destination) %>% sample_frac(1,replace=TRUE) %>% group_by(destination, export) %>% summarize(me = sum(revenue)/n())
for (j in 1:10){
boot_dest[i,j] <- as.numeric(bounds_dest_b[j,3])
}
}
LB_dest <- matrix(nrow = 5, ncol = 1)
UB_dest <- matrix(nrow = 5, ncol = 1)
for(j in 1:5){
ci <- 0
ku_dest <- 0
kl_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_dest[j,1] <- as.numeric(bounds_dest_o[2*j,3]) + ku_dest
LB_dest[j,1] <- as.numeric(bounds_dest_o[(2*j-1),3]) - kl_dest
boot_dest[i,(10+j)] <- (boot_dest[i,2*j] < UB_dest[j,1])*(boot_dest[i,(2*j-1)] > LB_dest[j,1])
}
ku_dest <- ku_dest + sd(boot_dest[,2*j])/20
kl_dest <- kl_dest + sd(boot_dest[,2*j-1])/20
ci <- sum(boot_dest[,(10+j)])
}
}
rm(table_all, table_dest,table_origin_dest,table_dest_year,dat,data)
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
N <- 10
bounds_origin_dest_o <- da %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_o_own <- bounds_origin_dest_o %>% filter((origin == destination))
bounds_origin_dest_o_cross <- bounds_origin_dest_o %>% filter((origin != destination))
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
}
LB_origin_dest <- matrix(nrow = 25, ncol = 1)
UB_origin_dest <- matrix(nrow = 25, ncol = 1)
for(j in 1:20){
ci <- 0
ku_origin_dest <- 0
kl_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[2*j,4]) + ku_origin_dest
LB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[(2*j-1),4]) - kl_origin_dest
boot_origin_dest[i,(50+j)] <- (boot_origin_dest[i,2*j] < UB_origin_dest[j])*(boot_origin_dest[i,(2*j-1)] > LB_origin_dest[j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,2*j])/20
kl_origin_dest <- kl_origin_dest + sd(boot_origin_dest[,2*j-1])/20
ci <- sum(boot_origin_dest[,(50+j)])
}
}
for(j in 1:5){
ci <- 0
ku_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[20+j,1] <- as.numeric(bounds_origin_dest_o_own[j,4]) + ku_origin_dest
LB_origin_dest[20+j,1] <- 0
boot_origin_dest[i,(70+j)] <- (boot_origin_dest[i,45+j] < UB_origin_dest[20+j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,45+j])/20
ci <- sum(boot_origin_dest[,(70+j)])
}
}
for(j in 1:25){
LB_origin_dest[j,1] <- as.numeric(LB_origin_dest[j,1])
UB_origin_dest[j,1] <- as.numeric(UB_origin_dest[j,1])
}
table_origin_dest <- matrix(nrow = 25, ncol = 6)
for(j in 1:25){
if(j<=20)
{
table_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,1])
table_origin_dest[j,2] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,2])
table_origin_dest[j,3] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,4])
table_origin_dest[j,4] <- as.numeric(bounds_origin_dest_o_cross[2*j,4])
table_origin_dest[j,5] <- LB_origin_dest[j,1]
table_origin_dest[j,6] <- UB_origin_dest[j,1]
}
else{
table_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_own[j-20,1])
table_origin_dest[j,2] <- as.numeric(bounds_origin_dest_o_own[j-20,2])
table_origin_dest[j,3] <- 0
table_origin_dest[j,4] <- as.numeric(bounds_origin_dest_o_own[j-20,4])
table_origin_dest[j,5] <- 0
table_origin_dest[j,6] <- UB_origin_dest[j,1]
}
}
table_origin_dest <- as.tibble(table_origin_dest)
names(table_origin_dest) <- c("origin","destination", "LB", "UB", "LB for 95% CI", "UB for 95% CI")
table_origin_dest <- arrange(table_origin_dest, origin, destination)
rm(UB_origin_dest,LB_origin_dest,kl_origin_dest,ku_origin_dest,boot_origin_dest,bounds_origin_dest_b,bounds_origin_dest_b_own,bounds_origin_dest_b_cross,bounds_origin_dest_o, bounds_origin_dest_o_own,bounds_origin_dest_o_cross)
print(table_origin_dest)
View(table_origin_dest)
data <- read_dta("predicted_revenue_for_exam.dta")
data
View(data)
u <- data %>% filter(ono == 5, is.na(s5)==TRUE)
View(u)
u <- data %>% filter(ono == 5, is.na(s4)==TRUE)
exp(15.70201)
exp(16.12796)
u <- data %>% filter(ono == 4, is.na(s5)==TRUE)
exp(18)
exp(17)
rm(table_all, table_dest,table_origin_dest,table_dest_year,dat,data)
rm(u)
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
View(boot_origin_dest)
UB_origin_dest
bounds_origin_dest_o_own[j,4]
bounds_origin_dest_o_own
j
UB_origin_dest
LB_origin_dest
bounds_origin_dest_b_cross
View(bounds_origin_dest_b_cross)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n()) %>% filter(origin==5, destination==4)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n()) %>% filter(origin==5, destination == 4)
rm(UB_origin_dest,LB_origin_dest,kl_origin_dest,ku_origin_dest,boot_origin_dest,bounds_origin_dest_b,bounds_origin_dest_b_own,bounds_origin_dest_b_cross,bounds_origin_dest_o, bounds_origin_dest_o_own,bounds_origin_dest_o_cross)
bounds_origin_dest_o <- da %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_o_own <- bounds_origin_dest_o %>% filter((origin == destination))
bounds_origin_dest_o_cross <- bounds_origin_dest_o %>% filter((origin != destination))
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
}
LB_origin_dest <- matrix(nrow = 25, ncol = 1)
UB_origin_dest <- matrix(nrow = 25, ncol = 1)
for(j in 1:20){
ci <- 0
ku_origin_dest <- 0
kl_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[2*j,4]) + ku_origin_dest
LB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[(2*j-1),4]) - kl_origin_dest
boot_origin_dest[i,(50+j)] <- (boot_origin_dest[i,2*j] < UB_origin_dest[j])*(boot_origin_dest[i,(2*j-1)] > LB_origin_dest[j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,2*j])/20
kl_origin_dest <- kl_origin_dest + sd(boot_origin_dest[,2*j-1])/20
ci <- sum(boot_origin_dest[,(50+j)])
}
}
for(j in 1:5){
ci <- 0
ku_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[20+j,1] <- as.numeric(bounds_origin_dest_o_own[j,4]) + ku_origin_dest
LB_origin_dest[20+j,1] <- 0
boot_origin_dest[i,(70+j)] <- (boot_origin_dest[i,45+j] < UB_origin_dest[20+j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,45+j])/20
ci <- sum(boot_origin_dest[,(70+j)])
}
}
View(bounds_origin_dest_b_cross)
View(boot_origin_dest)
data
data <- read_dta("predicted_revenue_for_exam.dta")
View(data)
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
#  bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
}
da %>% filter(origin == 5, destination == 4, export == 1)
da %>% filter(origin == 5, destination == 4, export == 1, is.na(revenue)==TRUE)
da %>% filter(origin == 5, destination == 4, export == 1)
U <- da %>% filter(origin == 5, destination == 4, export == 1)
View(U)
is.na(boot_origin_dest[,40])
sum(is.na(boot_origin_dest[,40]))
bounds_origin_dest_o <- da %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_o_own <- bounds_origin_dest_o %>% filter((origin == destination))
bounds_origin_dest_o_cross <- bounds_origin_dest_o %>% filter((origin != destination))
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
if(is.na(boot_origin_dest[i,40])!=0)
{
i= i-1
}
}
LB_origin_dest <- matrix(nrow = 25, ncol = 1)
UB_origin_dest <- matrix(nrow = 25, ncol = 1)
for(j in 1:20){
ci <- 0
ku_origin_dest <- 0
kl_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[2*j,4]) + ku_origin_dest
LB_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[(2*j-1),4]) - kl_origin_dest
boot_origin_dest[i,(50+j)] <- (boot_origin_dest[i,2*j] < UB_origin_dest[j])*(boot_origin_dest[i,(2*j-1)] > LB_origin_dest[j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,2*j])/20
kl_origin_dest <- kl_origin_dest + sd(boot_origin_dest[,2*j-1])/20
ci <- sum(boot_origin_dest[,(50+j)])
}
}
for(j in 1:5){
ci <- 0
ku_origin_dest <- 0
while(ci < N*0.95){
for (i in 1:N){
UB_origin_dest[20+j,1] <- as.numeric(bounds_origin_dest_o_own[j,4]) + ku_origin_dest
LB_origin_dest[20+j,1] <- 0
boot_origin_dest[i,(70+j)] <- (boot_origin_dest[i,45+j] < UB_origin_dest[20+j])
}
ku_origin_dest <- ku_origin_dest + sd(boot_origin_dest[,45+j])/20
ci <- sum(boot_origin_dest[,(70+j)])
}
}
for(j in 1:25){
LB_origin_dest[j,1] <- as.numeric(LB_origin_dest[j,1])
UB_origin_dest[j,1] <- as.numeric(UB_origin_dest[j,1])
}
table_origin_dest <- matrix(nrow = 25, ncol = 6)
for(j in 1:25){
if(j<=20)
{
table_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,1])
table_origin_dest[j,2] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,2])
table_origin_dest[j,3] <- as.numeric(bounds_origin_dest_o_cross[2*j-1,4])
table_origin_dest[j,4] <- as.numeric(bounds_origin_dest_o_cross[2*j,4])
table_origin_dest[j,5] <- LB_origin_dest[j,1]
table_origin_dest[j,6] <- UB_origin_dest[j,1]
}
else{
table_origin_dest[j,1] <- as.numeric(bounds_origin_dest_o_own[j-20,1])
table_origin_dest[j,2] <- as.numeric(bounds_origin_dest_o_own[j-20,2])
table_origin_dest[j,3] <- 0
table_origin_dest[j,4] <- as.numeric(bounds_origin_dest_o_own[j-20,4])
table_origin_dest[j,5] <- 0
table_origin_dest[j,6] <- UB_origin_dest[j,1]
}
}
table_origin_dest <- as.tibble(table_origin_dest)
names(table_origin_dest) <- c("origin","destination", "LB", "UB", "LB for 95% CI", "UB for 95% CI")
table_origin_dest <- arrange(table_origin_dest, origin, destination)
rm(UB_origin_dest,LB_origin_dest,kl_origin_dest,ku_origin_dest,boot_origin_dest,bounds_origin_dest_b,bounds_origin_dest_b_own,bounds_origin_dest_b_cross,bounds_origin_dest_o, bounds_origin_dest_o_own,bounds_origin_dest_o_cross)
print(table_origin_dest)
bounds_origin_dest_own
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
rm(table_all, table_dest,table_origin_dest,table_dest_year,dat,data)
rm(n1,n2,n3,n4,n5, enam1,enam2,enam3,enam4,enam5,datamat1,datamat2,datamat3,datamat4,datamat5,data1,data2,data3,data4,data5,datamatv,datav,enamv,i,j,k,n,nam,datamat)
rm(U)
rm(ci)
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
if(is.na(boot_origin_dest[i,40])!=0)
{
i= i-1
}
}
View(boot_origin_dest)
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
if(is.na(boot_origin_dest[i,40]) == TRUE)
{
i= i-1
}
}
View(boot_origin_dest)
is.na(boot_origin_dest[8,40]) == TRUE
View(boot_origin_dest)
da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
u <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
View(u)
u <- u %>% filter((origin == destination))
View(u)
u <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
u <- u %>% filter((origin != destination))
View(u)
u <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
u <- u %>% filter((origin != destination))
View(u)
u <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
u <- u %>% filter((origin != destination))
View(u)
bounds_origin_dest_o <- da %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_o_own <- bounds_origin_dest_o %>% filter((origin == destination))
bounds_origin_dest_o_cross <- bounds_origin_dest_o %>% filter((origin != destination))
boot_origin_dest <- matrix(nrow = N, ncol = 75)
for(i in 1:N){
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
bounds_origin_dest_b_own <- bounds_origin_dest_b %>% filter((origin == destination))
bounds_origin_dest_b_cross <- bounds_origin_dest_b %>% filter((origin != destination))
for (j in 1:40){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_cross[j,4])
}
if(is.na(boot_origin_dest[i,40]) == TRUE)
{
K <- bounds_origin_dest_b_cross
}
for(j in 41:45){
boot_origin_dest[i,j] <- 0
}
for(j in 46:50){
boot_origin_dest[i,j] <- as.numeric(bounds_origin_dest_b_own[j-45,4])
}
}
View(K)
u <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
u <- u %>% filter((origin != destination))
View(u)
bounds_origin_dest_b <- da %>% group_by(origin, destination) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
View(bounds_origin_dest_b)
bounds_origin_dest_b <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
u <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
View(u)
u <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(n = n())
View(u)
bounds_origin_dest_b <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
View(bounds_origin_dest_b)
bounds_origin_dest_b <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
View(bounds_origin_dest_b)
bounds_origin_dest_b <- da %>% group_by(origin, destination, export) %>% sample_frac(1,replace=TRUE) %>% group_by(origin, destination, export) %>% summarize(me = sum(revenue)/n())
View(bounds_origin_dest_b)
rm(table_all, table_dest,table_origin_dest,table_dest_year,dat,data)
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
library("stargazer", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
stargazer(table_origin_dest)
install.packages(htmlTable)
install.packages("htmlTable")
install.packages("htmlTable")
library(htmlTable)
install.packages("dplyr")
install.packages("dplyr")
install.packages("htmlTable")
library(htmlTable)
library(dplyr)
library(htmlTable)
detach("package:dplyr", unload=TRUE)
library("dplyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(htmlTable)
library("htmlTable", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("htmlTable")
library(htmlTable)
library(knitr)
options(knitr.table.format = "html")
library(kableExtra)
install.packages("kableExtra")
library(kableExtra)
kable(table_dest_year)
?knitr
?kable
kable(table_dest_year, align="c")
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
library(dplyr)
library("broom", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
detach("package:broom", unload=TRUE)
library(tidyverse)
source('~/Documents/GitHub/hktosun.github.io/coursework/IO/ECON8602/final_all.R')
library(tidyverse)
devtools::install_github()
blogdown::new_site()
